<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOL 7 ‚Äì Reading Test 1 ‚Äì Passage 2 ‚Äì Drawing Lessons from History</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }

        body {
            background: #1a1a2a;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            padding: 0;
        }

        .test-wrapper {
            width: 100%;
            max-width: 1600px;
            background: #f5f3ee;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Reading mode */
        .test-wrapper.reading-mode {
            background: #f8f5e6;
        }
        .test-wrapper.reading-mode .reading-panel { background: #fffaf0; }
        .test-wrapper.reading-mode .questions-panel { background: #fffaf0; }
        .test-wrapper.reading-mode .panel-header { background: #d6cdb8; color: #3a2e1f; }
        .test-wrapper.reading-mode .bottom-bar { background: #d6cdb8; }

        /* === HEADER === */
        .ielts-header {
            background: #1e3a5f;
            color: white;
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #e6b422;
        }
        .brand {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        .ielts-logo {
            background: #e6b422;
            color: #1e3a5f;
            font-weight: 800;
            font-size: 24px;
            padding: 4px 18px;
            border-radius: 40px;
        }
        .candidate { background: #2d4b77; padding: 4px 16px; border-radius: 30px; font-size: 14px; }
        .question-types { background: #0f2a44; padding: 4px 16px; border-radius: 30px; font-size: 13px; border: 1px solid #e6b422; }
        .timer { background: #0f2a44; padding: 6px 20px; border-radius: 40px; font-size: 22px; font-family: monospace; border: 1px solid #e6b422; }

        .reading-mode-toggle {
            display: flex; align-items: center; gap: 8px; background: #2d4b77; padding: 4px 12px; border-radius: 30px; cursor: pointer;
        }
        .toggle-switch {
            width: 40px; height: 20px; background: #0f2a44; border-radius: 20px; position: relative; transition: 0.3s; border: 1px solid #e6b422;
        }
        .toggle-switch.active { background: #e6b422; }
        .toggle-switch::after {
            content: ''; position: absolute; width: 16px; height: 16px; background: white; border-radius: 50%; top: 2px; left: 2px; transition: 0.3s;
        }
        .toggle-switch.active::after { left: 22px; }

        .font-controls {
            display: flex; gap: 5px; background: #2d4b77; padding: 3px; border-radius: 30px;
        }
        .font-btn {
            width: 32px; height: 32px; border-radius: 50%; border: none; background: transparent; color: white; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        .font-btn:hover { background: #3e5f8a; }
        .font-btn.active { background: #e6b422; color: #1e3a5f; }

        /* navigator */
        .question-nav {
            background: #d2cbbc; padding: 6px 20px; border-bottom: 2px solid #b0aa9a; display: flex; align-items: center; gap: 15px; flex-wrap: wrap;
        }
        .nav-buttons { display: flex; gap: 4px; flex-wrap: wrap; }
        .nav-btn {
            width: 32px; height: 32px; border-radius: 6px; border: 2px solid #1e3a5f; background: white; color: #1e3a5f; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .nav-btn:hover { background: #e6b422; border-color: #e6b422; }
        .nav-btn.answered { background: #4CAF50; color: white; border-color: #2e7d32; }
        .nav-btn.unanswered { background: #e0e0e0; color: #757575; border-color: #9e9e9e; }
        .nav-btn.active { border: 3px solid #e6b422; transform: scale(1.05); }

        /* main resizable columns */
        .main-area {
            display: flex; flex: 1; overflow: hidden;
        }
        .reading-panel {
            width: 45%; background: #fffcf5; border-right: 2px solid #b0aa9a; display: flex; flex-direction: column; overflow: hidden;
        }
        .questions-panel {
            width: 55%; background: #f8f6f0; display: flex; flex-direction: column; overflow: hidden;
        }
        .resizer {
            width: 8px; background: #b0aa9a; cursor: col-resize; transition: 0.1s;
        }
        .resizer:hover { background: #e6b422; }

        .panel-header {
            background: #d2cbbc; padding: 8px 15px; font-weight: 600; color: #1e3a5f; border-bottom: 1px solid #b0aa9a; display: flex; justify-content: space-between;
        }
        .reading-text {
            flex: 1; overflow-y: auto; padding: 20px; line-height: 1.7; font-size: 15px;
        }
        .questions-list {
            flex: 1; overflow-y: auto; padding: 20px 25px; line-height: 1.6; font-size: 15px;
        }

        /* font sizes */
        .font-small { font-size: 13px; } .font-medium { font-size: 15px; } .font-large { font-size: 17px; }

        /* highlights */
        .highlight-yellow { background-color: #f9e79f; border-radius: 3px; }
        .highlight-green { background-color: #a9d6b0; }
        .highlight-pink { background-color: #fbb9c0; }
        .answer-highlight { background-color: #f9e79f; padding: 2px 0; border-radius: 4px; }
        .question-highlight { background-color: #fef9e7; border-left: 4px solid #f1c40f; padding-left: 10px; }

        /* context menu */
        .context-menu {
            position: fixed; background: white; border: 1px solid #9a8c7a; box-shadow: 2px 2px 10px rgba(0,0,0,0.2); padding: 5px 0; border-radius: 8px; z-index: 1000; display: none; min-width: 150px;
        }
        .context-menu div { padding: 8px 20px; cursor: pointer; transition: 0.2s; }
        .context-menu div:hover { background: #1e3a5f; color: white; }

        /* question styles */
        .note-box {
            background: #f0ebe0; border-left: 4px solid #e6b422; padding: 12px 15px; margin: 15px 0; font-style: italic;
        }
        .mcq-options { margin: 10px 0 20px 30px; list-style: none; }
        .mcq-option { display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .tf-group { margin: 5px 0 15px 25px; display: flex; gap: 20px; flex-wrap: wrap; }
        .tf-option { display: inline-flex; align-items: center; gap: 5px; cursor: pointer; }
        .tf-option.correct .tf-text { color: #4CAF50; font-weight: bold; }
        .tf-option.incorrect .tf-text { color: #f44336; font-weight: bold; }

        .question-wrapper { display: flex; align-items: center; flex-wrap: wrap; gap: 5px; }
        .question-number { font-weight: bold; color: #1e3a5f; margin-right: 5px; min-width: 25px; }

        /* input styles cho c√¢u 22-26 */
        .letter-input {
            width: 45px;
            text-align: center;
            text-transform: uppercase;
            font-weight: bold;
            border: none;
            border-bottom: 2px solid #bdc3c7;
            background: #fafafa;
            padding: 2px 5px;
            font-size: 1em;
            transition: 0.2s;
            outline: none;
            border-radius: 4px 4px 0 0;
            margin: 0 5px;
            font-family: 'Times New Roman';
        }
        .letter-input.correct {
            border-bottom-color: #27ae60 !important;
            background-color: #e8f8f5 !important;
            color: #1e8449 !important;
        }
        .letter-input.incorrect-marked {
            border-bottom-color: #e74c3c !important;
            background-color: #fdedec !important;
        }

        /* eye icon v√† hint */
        .eye-icon {
            display: inline-block; margin-left: 8px; cursor: pointer; font-size: 18px; opacity: 0.7; transition: 0.2s;
        }
        .eye-icon:hover { opacity: 1; transform: scale(1.1); }
        .eye-icon.active { opacity: 1; color: #e6b422; }

        /* bottom bar */
        .bottom-bar {
            background: #d2cbbc;
            padding: 10px 20px;
            display: flex;
            gap: 15px;
            border-top: 1px solid #b0aa9a;
            align-items: center;
            flex-wrap: wrap;
        }
        .btn {
            padding: 6px 20px;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .btn-primary { background: #1e3a5f; color: white; }
        .btn-primary:hover { background: #2d4b77; }
        .btn-primary:disabled { background: #9aaec2; cursor: not-allowed; opacity: 0.6; }
        
        .btn-success { background: #4CAF50; color: white; }
        .btn-success:hover { background: #45a049; }
        .btn-success:disabled { 
            background: #a5d6a7; 
            cursor: not-allowed; 
            opacity: 0.6;
            pointer-events: none;
        }
        
        .btn-danger { background: #f44336; color: white; }
        .btn-danger:hover { background: #d32f2f; }
        
        .progress { background: white; border-radius: 20px; padding: 4px 12px; font-weight: 600; color: #1e3a5f; border: 1px solid #1e3a5f; }
        .result-stats { background: #1e3a5f; color: white; border-radius: 20px; padding: 4px 12px; }

        /* explanation panel */
        .explanation-panel {
            background: #fffef9; border-left: 4px solid #e6b422; padding: 12px 20px; margin: 0 20px 12px 20px; border-radius: 8px; display: none;
        }
        .explanation-panel.show { display: block; }
        .explanation-header { font-weight: 700; color: #1e3a5f; margin-bottom: 8px; display: flex; justify-content: space-between; }
        .close-btn { cursor: pointer; color: #666; }
        .close-btn:hover { color: #1e3a5f; }

        .answer-feedback.correct { background: #e8f5e8; border-left: 4px solid #4CAF50; }
        .answer-feedback.incorrect { background: #ffebee; border-left: 4px solid #f44336; }

        .question-item {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 3px solid transparent;
            transition: all 0.2s;
            scroll-margin-top: 20px;
        }
        .question-item.highlight-question {
            border-left: 3px solid #f1c40f;
            background-color: #fef9e7;
        }

        .wordbank-list {
            background: #f8f4e8;
            border: 1px solid #d2cbbc;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 15px 0 25px 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px 20px;
        }
        .wordbank-item {
            font-size: 0.95em;
            color: #1e3a5f;
        }
        .wordbank-item strong {
            font-weight: 700;
            margin-right: 5px;
        }
    </style>
</head>
<body>
<div class="test-wrapper" id="testWrapper">
    <!-- Header -->
    <div class="ielts-header">
        <div class="brand">
            <div class="ielts-logo">IELTS</div>
            <div class="candidate">Vol 7 - Test 1 - Passage 2</div>
            <div class="question-types">Multiple choice ‚Ä¢ Yes/No/NG ‚Ä¢ Sentence endings</div>
            <div class="reading-mode-toggle" id="readingModeToggle">
                <div class="toggle-switch" id="toggleSwitch"></div>
                <span class="toggle-label">ƒê·ªçc s√°ch</span>
            </div>
            <div class="font-controls">
                <button class="font-btn" id="fontSmall">A-</button>
                <button class="font-btn active" id="fontMedium">A</button>
                <button class="font-btn" id="fontLarge">A+</button>
            </div>
        </div>
        <div class="timer" id="timerDisplay">60:00</div>
    </div>

    <!-- Question Navigator -->
    <div class="question-nav">
        <span style="font-weight:600; color:#1e3a5f;">C√¢u 14-26:</span>
        <div class="nav-buttons" id="navButtons"></div>
    </div>

    <!-- Main Resizable Area -->
    <div class="main-area" id="mainArea">
        <!-- Reading Panel (Passage 2) -->
        <div class="reading-panel" id="readingPanel">
            <div class="panel-header">
                <span>READING PASSAGE 2: Drawing Lessons from History</span>
                <span>* Kh√¥ng highlight c√°c c√¢u kh√°c ƒëo·∫°n c√πng l√∫c!</span>
            </div>
            <div class="reading-text font-medium" id="readingContent">
                <h1>Drawing Lessons from History</h1>
                <p>Numerous ancient civilisations collapsed or disappeared, leaving behind grand ruins reminiscent of what poet Shelley described in his sonnet <em>Ozymandias</em>. The term ‚Äòcollapse‚Äô refers to a significant reduction in population and/or political, economic, and social complexity of a society across a wide area for an extended period.</p>
                <p>The awe-inspiring ruins left behind by these past societies captivate us all. As children, we marvel at them when we first discover them through pictures ‚Äî vast stone structures, intricate carvings, or towering temples that defy imagination. As we grow older, many of us plan vacations to witness these remarkable sites firsthand, standing in silent reverence before the remnants of a world that once thrived. We are drawn to their magnificent and haunting beauty, as well as the enigmas they present. The grandeur of these ruins attests to the previous wealth and power of their builders, yet their sudden disappearance challenges our understanding of human resilience. These builders vanished, abandoning the remarkable structures they had painstakingly constructed. How did a once-mighty society end up collapsing, leaving behind only echoes of its former glory?</p>
                <p>For a long time, it has been suspected that the mysterious disappearance of many such societies was, to some extent, triggered by ecological issues and unintentional destruction of the environmental resources on which their societies relied. This suspicion of unintended ecological suicide, or ecocide, has been substantiated by discoveries made in recent decades by archaeologists, climatologists, historians, palaeontologists, and palynologists (pollen scientists). The processes through which past societies have undermined themselves by damaging their environments can be categorised into eight areas, which vary in significance from one case to another: deforestation and habitat loss, soil degradation, water management challenges, overhunting, overfishing, the impacts of invasive species on native ones, human population growth, and increased human activity.</p>
                <p>Historical collapses generally followed similar patterns resembling variations on a theme. These patterns often include resource depletion, environmental degradation, internal strife, or external pressures, yet the specific combination and intensity of these factors varied across civilisations. Writers are often tempted to draw analogies between the trajectory of human society and that of an individual‚Äôs life, speaking of a society‚Äôs birth, growth, peak, old age, and eventual demise. However, this metaphor proves inaccurate for many past societies: they experienced rapid declines after reaching their peak in terms of population and power, and these rapid declines must have come as a surprise and shock to their inhabitants. It is evident that not all past societies followed this trajectory uniformly to its conclusion: different societies collapsed to varying degrees and in somewhat distinct ways while many societies did not collapse at all. The diversity in collapse mechanisms suggests that while certain systemic vulnerabilities may be universal, their expression is deeply contingent on local conditions, cultural responses, and the interplay of multiple stressors over time.</p>
                <p>Currently, many individuals believe that environmental problems eclipse other global threats. These environmental problems encompass the same eight factors that contributed to past societies‚Äô downfalls, plus four new ones: human-induced climate change, the accumulation of toxic chemicals, energy shortages, and the complete utilisation of the Earth‚Äôs photosynthetic capacity. However, the seriousness of these modern environmental dilemmas is vigorously debated among the scientific community. Are the perceived risks overstated or undervalued? Will contemporary technology resolve our issues, or is it producing new challenges faster than it can remedy old ones? When one resource (such as wood, oil, or ocean fish) is depleted, can we trust that new alternatives (like plastics, wind and solar energy, or farmed fish) will emerge? Isn‚Äôt the rate of human population growth slowing down, suggesting we might soon reach a manageable global population?</p>
                <p>Questions like these highlight why the well-known collapses of past civilisations carry more significance than merely being romantic mysteries. There may be practical lessons to be learnt from these historical failures. However, there are also differences between the modern world and its problems, and those ancient societies and their problems. It would be naive to assume that studying the past will yield straightforward answers directly applicable to today‚Äôs world. We have certain advantages over past societies that reduce our risks, including our powerful technology (i.e. its beneficial effects), globalisation, modern medicine, and enhanced awareness of both past and distant modern societies. At the same time, there are also factors that heighten our risks in comparison to earlier civilisations: again, our potent technology (i.e. its unintended destructive effects), globalisation (where a problem in one area can affect the entire world), the reliance of millions on modern health care for survival, and our vastly larger human population. Perhaps we can still learn from the past, but only if we carefully contemplate its lessons.</p>
            </div>
        </div>
        <div class="resizer" id="resizer"></div>

        <!-- Questions Panel -->
        <div class="questions-panel" id="questionsPanel">
            <div class="panel-header">
                <span>QUESTIONS 14-26</span>
                <span class="answer-badge" id="answeredCount">0/13 answered</span>
            </div>
            <div class="questions-list font-medium" id="questionsContent">

                <!-- Questions 14-16 Multiple choice -->
                <h3>Questions 14-16</h3>
                <p><em>Choose the correct answer.</em></p>
                <div class="question-item" id="q14-item">
                    <div class="question-wrapper"><span class="question-number">14.</span> In describing the appeal of monumental ruins, the writer highlights</div>
                    <ul class="mcq-options">
                        <li><label class="mcq-option"><input type="radio" name="q14" value="A"> A. the curiosity of historians about the original purpose of these ruins.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q14" value="B"> B. the vast geographical areas covered by these structures.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q14" value="C"> C. their profound impact on the field of archaeological research.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q14" value="D"> D. the mixture of beauty and mystery these sites represent.</label></li>
                    </ul>
                    <span class="eye-icon" data-question="14" style="display:none;">üëÅÔ∏è</span>
                </div>
                <div class="question-item" id="q15-item">
                    <div class="question-wrapper"><span class="question-number">15.</span> Recent findings regarding lost civilisations have</div>
                    <ul class="mcq-options">
                        <li><label class="mcq-option"><input type="radio" name="q15" value="A"> A. upended established theories.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q15" value="B"> B. triggered a heated debate among scientists.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q15" value="C"> C. emerged from a range of disciplines.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q15" value="D"> D. confirmed a major cause of environmental destruction.</label></li>
                    </ul>
                    <span class="eye-icon" data-question="15" style="display:none;">üëÅÔ∏è</span>
                </div>
                <div class="question-item" id="q16-item">
                    <div class="question-wrapper"><span class="question-number">16.</span> In discussing how previous societies fell, the writer mentions that</div>
                    <ul class="mcq-options">
                        <li><label class="mcq-option"><input type="radio" name="q16" value="A"> A. the pace of collapse showed some resemblance across societies.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q16" value="B"> B. the decline of societies was usually a slow and predictable process.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q16" value="C"> C. all societies peaked in terms of population and power before collapsing.</label></li>
                        <li><label class="mcq-option"><input type="radio" name="q16" value="D"> D. ordinary people could occasionally affect the course of events.</label></li>
                    </ul>
                    <span class="eye-icon" data-question="16" style="display:none;">üëÅÔ∏è</span>
                </div>

                <!-- Questions 17-21 Yes/No/Not Given -->
                <h3>Questions 17-21</h3>
                <p><em>Do the following statements agree with the claims of the writer? Write <strong>YES / NO / NOT GIVEN</strong>.</em></p>
                <div class="note-box">
                    <p><strong>YES</strong> if the statement agrees with the claims<br><strong>NO</strong> if contradicts<br><strong>NOT GIVEN</strong> if impossible to say</p>
                </div>
                <ol style="list-style:none; padding-left:0;">
                    <li class="question-item" id="q17-item">
                        <div class="question-wrapper"><span class="question-number">17.</span> The impressive relics of ancient societies were influenced by Shelley‚Äôs sonnet Ozymandias.</div>
                        <div class="tf-group" id="q17-group">
                            <label class="tf-option"><input type="radio" name="q17" value="YES"> <span class="tf-text">YES</span></label>
                            <label class="tf-option"><input type="radio" name="q17" value="NO"> <span class="tf-text">NO</span></label>
                            <label class="tf-option"><input type="radio" name="q17" value="NOT GIVEN"> <span class="tf-text">NOT GIVEN</span></label>
                        </div>
                        <span class="eye-icon" data-question="17" style="display:none;">üëÅÔ∏è</span>
                    </li>
                    <li class="question-item" id="q18-item">
                        <div class="question-wrapper"><span class="question-number">18.</span> There is a widespread belief that environmental issues pose the principal hazard to the contemporary world.</div>
                        <div class="tf-group" id="q18-group">
                            <label class="tf-option"><input type="radio" name="q18" value="YES"> <span class="tf-text">YES</span></label>
                            <label class="tf-option"><input type="radio" name="q18" value="NO"> <span class="tf-text">NO</span></label>
                            <label class="tf-option"><input type="radio" name="q18" value="NOT GIVEN"> <span class="tf-text">NOT GIVEN</span></label>
                        </div>
                        <span class="eye-icon" data-question="18" style="display:none;">üëÅÔ∏è</span>
                    </li>
                    <li class="question-item" id="q19-item">
                        <div class="question-wrapper"><span class="question-number">19.</span> Scientists have reached a consensus about how severe the present ecological concerns are.</div>
                        <div class="tf-group" id="q19-group">
                            <label class="tf-option"><input type="radio" name="q19" value="YES"> <span class="tf-text">YES</span></label>
                            <label class="tf-option"><input type="radio" name="q19" value="NO"> <span class="tf-text">NO</span></label>
                            <label class="tf-option"><input type="radio" name="q19" value="NOT GIVEN"> <span class="tf-text">NOT GIVEN</span></label>
                        </div>
                        <span class="eye-icon" data-question="19" style="display:none;">üëÅÔ∏è</span>
                    </li>
                    <li class="question-item" id="q20-item">
                        <div class="question-wrapper"><span class="question-number">20.</span> The presence of poisonous substances in high concentrations is a relatively modern issue.</div>
                        <div class="tf-group" id="q20-group">
                            <label class="tf-option"><input type="radio" name="q20" value="YES"> <span class="tf-text">YES</span></label>
                            <label class="tf-option"><input type="radio" name="q20" value="NO"> <span class="tf-text">NO</span></label>
                            <label class="tf-option"><input type="radio" name="q20" value="NOT GIVEN"> <span class="tf-text">NOT GIVEN</span></label>
                        </div>
                        <span class="eye-icon" data-question="20" style="display:none;">üëÅÔ∏è</span>
                    </li>
                    <li class="question-item" id="q21-item">
                        <div class="question-wrapper"><span class="question-number">21.</span> We should reflect cautiously when comparing the past with the present.</div>
                        <div class="tf-group" id="q21-group">
                            <label class="tf-option"><input type="radio" name="q21" value="YES"> <span class="tf-text">YES</span></label>
                            <label class="tf-option"><input type="radio" name="q21" value="NO"> <span class="tf-text">NO</span></label>
                            <label class="tf-option"><input type="radio" name="q21" value="NOT GIVEN"> <span class="tf-text">NOT GIVEN</span></label>
                        </div>
                        <span class="eye-icon" data-question="21" style="display:none;">üëÅÔ∏è</span>
                    </li>
                </ol>

                <!-- Questions 22-26 Sentence endings -->
                <h3>Questions 22-26</h3>
                <p><em>Complete each sentence with the correct ending, A-F, below.</em></p>
                
                <!-- Danh s√°ch A-F -->
                <div class="wordbank-list">
                    <div class="wordbank-item"><strong>A.</strong> are not applicable to all societies.</div>
                    <div class="wordbank-item"><strong>B.</strong> provides a hopeful perspective.</div>
                    <div class="wordbank-item"><strong>C.</strong> is embodied in physical structures.</div>
                    <div class="wordbank-item"><strong>D.</strong> is potentially both positive and negative.</div>
                    <div class="wordbank-item"><strong>E.</strong> will not address current issues directly.</div>
                    <div class="wordbank-item"><strong>F.</strong> have increased compared to the past.</div>
                </div>

                <!-- C√°c c√¢u 22-26 v·ªõi √¥ input -->
                <div style="margin:20px 0;">
                    <div style="margin-bottom: 20px; display: flex; align-items: center; flex-wrap: wrap;" class="question-item" id="q22-item">
                        <span class="question-number">22.</span> 
                        <span>Evidence of remarkable achievements of certain past civilisations</span>
                        <input type="text" class="letter-input" id="q22" data-answer="C" maxlength="1" style="margin-left: 10px;">
                        <span class="eye-icon" data-question="22" style="display:none;">üëÅÔ∏è</span>
                    </div>
                    <div style="margin-bottom: 20px; display: flex; align-items: center; flex-wrap: wrap;" class="question-item" id="q23-item">
                        <span class="question-number">23.</span> 
                        <span>Analogies between the development of an individual and that of a society</span>
                        <input type="text" class="letter-input" id="q23" data-answer="A" maxlength="1" style="margin-left: 10px;">
                        <span class="eye-icon" data-question="23" style="display:none;">üëÅÔ∏è</span>
                    </div>
                    <div style="margin-bottom: 20px; display: flex; align-items: center; flex-wrap: wrap;" class="question-item" id="q24-item">
                        <span class="question-number">24.</span> 
                        <span>The environmental challenges that societies encounter</span>
                        <input type="text" class="letter-input" id="q24" data-answer="F" maxlength="1" style="margin-left: 10px;">
                        <span class="eye-icon" data-question="24" style="display:none;">üëÅÔ∏è</span>
                    </div>
                    <div style="margin-bottom: 20px; display: flex; align-items: center; flex-wrap: wrap;" class="question-item" id="q25-item">
                        <span class="question-number">25.</span> 
                        <span>In modern society, powerful technology</span>
                        <input type="text" class="letter-input" id="q25" data-answer="D" maxlength="1" style="margin-left: 10px;">
                        <span class="eye-icon" data-question="25" style="display:none;">üëÅÔ∏è</span>
                    </div>
                    <div style="margin-bottom: 20px; display: flex; align-items: center; flex-wrap: wrap;" class="question-item" id="q26-item">
                        <span class="question-number">26.</span> 
                        <span>Reflections on ancient events and tendencies</span>
                        <input type="text" class="letter-input" id="q26" data-answer="E" maxlength="1" style="margin-left: 10px;">
                        <span class="eye-icon" data-question="26" style="display:none;">üëÅÔ∏è</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Bar -->
    <div class="bottom-bar">
        <button class="btn btn-primary" id="submitBtn">N·ªôp b√†i</button>
        <button class="btn btn-success" id="explainBtn" disabled>Xem gi·∫£i th√≠ch</button>
        <button class="btn btn-danger" id="resetBtn">Reset t·∫•t c·∫£</button>
        <div class="progress" id="progressDisplay">ƒê√£ l√†m: 0/13</div>
        <div class="result-stats" id="resultStats" style="display:none;"></div>
    </div>

    <!-- Explanation Panel -->
    <div class="explanation-panel" id="explanationPanel">
        <div class="explanation-header">
            <span id="explanationTitle">Gi·∫£i th√≠ch</span>
            <span class="close-btn" id="closeExplanation">‚úï ƒê√≥ng</span>
        </div>
        <div class="explanation-content" id="explanationText">Nh·∫•n v√†o bi·ªÉu t∆∞·ª£ng con m·∫Øt ƒë·ªÉ xem gi·∫£i th√≠ch.</div>
    </div>

    <!-- Right-click context menu -->
    <div class="context-menu" id="contextMenu">
        <div onclick="applyHighlight('yellow')">Highlight v√†ng</div>
        <div onclick="applyHighlight('green')">Highlight xanh l√°</div>
        <div onclick="applyHighlight('pink')">Highlight h·ªìng</div>
        <div onclick="removeHighlight()">X√≥a highlight ƒëang ch·ªçn</div>
    </div>
</div>

<script>
    // ==================== GLOBAL VARIABLES ====================
    let selectedRange = null;
    let selectedTarget = null;
    let currentHighlightedQuestion = null;
    let examSubmitted = false;
    let explanationMode = false;
    let startTime = Date.now();
    let endTime = null;
    let readingMode = false;

    // ANSWER KEY
    const answerKey = {
        q14: 'D', q15: 'C', q16: 'A',
        q17: 'NOT GIVEN', q18: 'YES', q19: 'NO', q20: 'YES', q21: 'YES',
        q22: 'C', q23: 'A', q24: 'F', q25: 'D', q26: 'E'
    };

    // Answer locations for highlight
    const answerLocations = {
        q14: { text: "We are drawn to their magnificent and haunting beauty, as well as the enigmas they present." },
        q15: { text: "archaeologists, climatologists, historians, palaeontologists, and palynologists" },
        q16: { text: "Historical collapses generally followed similar patterns" },
        q17: { text: "Ozymandias" },
        q18: { text: "many individuals believe that environmental problems eclipse other global threats" },
        q19: { text: "vigorously debated" },
        q20: { text: "accumulation of toxic chemicals" },
        q21: { text: "only if we carefully contemplate its lessons" },
        q22: { text: "grandeur of these ruins attests to the previous wealth and power" },
        q23: { text: "metaphor proves inaccurate for many past societies" },
        q24: { text: "plus four new ones" },
        q25: { text: "powerful technology (i.e. its beneficial effects) ‚Ä¶ also factors that heighten our risks" },
        q26: { text: "naive to assume that studying the past will yield straightforward answers" }
    };

    // Explanations
    const explanations = {
        q14: "ƒê√°p √°n D. 'magnificent and haunting beauty, as well as the enigmas' ‚Üí beauty + mystery.",
        q15: "ƒê√°p √°n C. C√°c chuy√™n gia t·ª´ nhi·ªÅu lƒ©nh v·ª±c kh√°c nhau ‚Üí range of disciplines.",
        q16: "ƒê√°p √°n A. 'followed similar patterns' ‚Üí pace c√≥ resemblance.",
        q17: "NOT GIVEN. Shelley ch·ªâ ƒë∆∞·ª£c nh·∫Øc ·ªü ƒë·∫ßu, kh√¥ng n√≥i ·∫£nh h∆∞·ªüng ƒë·∫øn relics.",
        q18: "YES. 'many individuals believe that environmental problems eclipse other global threats.'",
        q19: "NO. 'vigorously debated' ‚Üí kh√¥ng consensus.",
        q20: "YES. 'accumulation of toxic chemicals' l√† m·ªôt trong b·ªën v·∫•n ƒë·ªÅ hi·ªán ƒë·∫°i.",
        q21: "YES. 'only if we carefully contemplate its lessons' ‚Üí c·∫ßn th·∫≠n tr·ªçng.",
        q22: "ƒê√°p √°n C. 'grandeur of these ruins attests to wealth and power' ‚Üí physical structures.",
        q23: "ƒê√°p √°n A. metaphor kh√¥ng ƒë√∫ng v·ªõi nhi·ªÅu x√£ h·ªôi (not applicable).",
        q24: "ƒê√°p √°n F. 8 c≈© + 4 m·ªõi ‚Üí increased.",
        q25: "ƒê√°p √°n D. v·ª´a beneficial v·ª´a destructive ‚Üí both positive and negative.",
        q26: "ƒê√°p √°n E. 'naive to assume ‚Ä¶ straightforward answers' ‚Üí will not address directly."
    };

    // ==================== TIMER ====================
    let timeLeft = 3600;
    const timerEl = document.getElementById('timerDisplay');
    const timerInterval = setInterval(() => {
        if (timeLeft > 0) {
            timeLeft--;
            const mins = Math.floor(timeLeft / 60);
            const secs = timeLeft % 60;
            timerEl.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
    }, 1000);

    // ==================== READING MODE TOGGLE ====================
    const testWrapper = document.getElementById('testWrapper');
    const toggleSwitch = document.getElementById('toggleSwitch');
    
    document.getElementById('readingModeToggle').addEventListener('click', () => {
        readingMode = !readingMode;
        if (readingMode) {
            testWrapper.classList.add('reading-mode');
            toggleSwitch.classList.add('active');
        } else {
            testWrapper.classList.remove('reading-mode');
            toggleSwitch.classList.remove('active');
        }
    });

    // ==================== FONT SIZE CONTROLS ====================
    document.getElementById('fontSmall').addEventListener('click', () => setFontSize('small'));
    document.getElementById('fontMedium').addEventListener('click', () => setFontSize('medium'));
    document.getElementById('fontLarge').addEventListener('click', () => setFontSize('large'));

    function setFontSize(size) {
        document.querySelectorAll('.font-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`font${size.charAt(0).toUpperCase() + size.slice(1)}`).classList.add('active');
        document.getElementById('readingContent').className = `reading-text font-${size}`;
        document.getElementById('questionsContent').className = `questions-list font-${size}`;
    }

    // ==================== RESIZE COLUMNS ====================
    const readingPanel = document.getElementById('readingPanel');
    const questionsPanel = document.getElementById('questionsPanel');
    const resizer = document.getElementById('resizer');
    let isResizing = false;

    resizer.addEventListener('mousedown', () => {
        isResizing = true;
        document.body.style.cursor = 'col-resize';
    });

    document.addEventListener('mousemove', (e) => {
        if (!isResizing) return;
        const mainArea = document.getElementById('mainArea');
        const rect = mainArea.getBoundingClientRect();
        let readingWidth = e.clientX - rect.left - 4;
        if (readingWidth < 250) readingWidth = 250;
        if (readingWidth > rect.width - 250) readingWidth = rect.width - 250;
        readingPanel.style.width = readingWidth + 'px';
        questionsPanel.style.width = (rect.width - readingWidth - 8) + 'px';
    });

    document.addEventListener('mouseup', () => {
        isResizing = false;
        document.body.style.cursor = 'default';
    });

    // ==================== NAVIGATION BUTTONS ====================
    function createNavButtons() {
        const navContainer = document.getElementById('navButtons');
        navContainer.innerHTML = '';
        for (let i = 14; i <= 26; i++) {
            const btn = document.createElement('button');
            btn.className = 'nav-btn unanswered';
            btn.textContent = i;
            btn.setAttribute('data-question', i);
            btn.addEventListener('click', function() {
                const qNum = this.getAttribute('data-question');
                scrollToQuestion(qNum);
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
            navContainer.appendChild(btn);
        }
    }

    function scrollToQuestion(questionNum) {
        let element = document.getElementById(`q${questionNum}-item`) || document.getElementById(`q${questionNum}`);
        if (element) {
            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }

    function updateNavButtons() {
        for (let i = 14; i <= 26; i++) {
            const btn = document.querySelector(`.nav-btn[data-question="${i}"]`);
            if (!btn) continue;
            let isAnswered = !!getUserAnswer(i);
            btn.classList.remove('answered', 'unanswered');
            btn.classList.add(isAnswered ? 'answered' : 'unanswered');
        }
    }

    // ==================== GET USER ANSWER ====================
    function getUserAnswer(q) {
        if (q <= 16) {
            let sel = document.querySelector(`input[name="q${q}"]:checked`);
            return sel ? sel.value : null;
        } else if (q <= 21) {
            let sel = document.querySelector(`input[name="q${q}"]:checked`);
            return sel ? sel.value : null;
        } else {
            let input = document.getElementById(`q${q}`);
            return input ? input.value.trim().toUpperCase() || null : null;
        }
    }

    // ==================== UPDATE ANSWER COUNT ====================
    function updateAnswerCount() {
        let answered = 0;
        for (let i = 14; i <= 26; i++) {
            if (getUserAnswer(i)) answered++;
        }
        document.getElementById('answeredCount').textContent = `${answered}/13 answered`;
        document.getElementById('progressDisplay').textContent = `ƒê√£ l√†m: ${answered}/13`;
        updateNavButtons();
    }

    // ==================== HIGHLIGHT FUNCTIONS ====================
    function clearAllHighlights() {
        document.querySelectorAll('.answer-highlight').forEach(el => {
            el.classList.remove('answer-highlight');
        });
        document.querySelectorAll('.question-highlight').forEach(el => {
            el.classList.remove('question-highlight');
        });
        document.querySelectorAll('.eye-icon.active').forEach(el => {
            el.classList.remove('active');
        });
        currentHighlightedQuestion = null;
    }

    function highlightQuestion(questionNum) {
        document.querySelectorAll('.question-highlight').forEach(el => el.classList.remove('question-highlight'));
        let target = document.getElementById(`q${questionNum}-item`) || document.getElementById(`q${questionNum}`)?.closest('.question-item');
        if (target) target.classList.add('question-highlight');
    }

    function highlightAnswerLocation(questionNum) {
        document.querySelectorAll('.answer-highlight').forEach(el => {
            const parent = el.parentNode;
            if (parent) {
                while (el.firstChild) {
                    parent.insertBefore(el.firstChild, el);
                }
                parent.removeChild(el);
            }
        });
        
        const readingContent = document.getElementById('readingContent');
        const location = answerLocations[`q${questionNum}`];
        if (!location) return false;
        
        const text = location.text;
        const paragraphs = readingContent.getElementsByTagName('p');
        
        for (let p of paragraphs) {
            if (p.textContent.includes(text)) {
                try {
                    const html = p.innerHTML;
                    const newHtml = html.replace(text, `<span class="answer-highlight">${text}</span>`);
                    p.innerHTML = newHtml;
                    const highlighted = p.querySelector('.answer-highlight');
                    if (highlighted) {
                        highlighted.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    document.querySelectorAll('.eye-icon').forEach(icon => icon.classList.remove('active'));
                    const eyeIcon = document.querySelector(`.eye-icon[data-question="${questionNum}"]`);
                    if (eyeIcon) eyeIcon.classList.add('active');
                    currentHighlightedQuestion = questionNum;
                    return true;
                } catch (e) {
                    console.log('Kh√¥ng th·ªÉ highlight ƒëo·∫°n n√†y:', e);
                }
                break;
            }
        }
        return false;
    }

    // ==================== SHOW EXPLANATION ====================
    function showExplanation(questionNum) {
        if (!explanationMode) return;
        
        if (explanations[`q${questionNum}`]) {
            document.getElementById('explanationPanel').classList.add('show');
            document.getElementById('explanationTitle').textContent = `Gi·∫£i th√≠ch c√¢u ${questionNum}`;
            
            let explanationHtml = explanations[`q${questionNum}`];
            
            if (examSubmitted) {
                const userAnswer = getUserAnswer(questionNum);
                const correctAnswer = answerKey[`q${questionNum}`];
                
                if (userAnswer) {
                    const isCorrect = userAnswer.toString().toUpperCase() === correctAnswer.toString().toUpperCase();
                    explanationHtml += `<div class="answer-feedback ${isCorrect ? 'correct' : 'incorrect'}">`;
                    explanationHtml += `<strong>C√¢u tr·∫£ l·ªùi c·ªßa b·∫°n:</strong> ${userAnswer}<br>`;
                    if (!isCorrect) {
                        explanationHtml += `<strong>ƒê√°p √°n ƒë√∫ng:</strong> ${correctAnswer}`;
                    }
                    explanationHtml += `</div>`;
                }
            }
            
            document.getElementById('explanationText').innerHTML = explanationHtml;
            
            setTimeout(() => {
                highlightAnswerLocation(questionNum);
                highlightQuestion(questionNum);
            }, 100);
        }
    }

    // ==================== MARK ANSWERS ====================
    function markAnswers() {
        // Mark MCQ 14-16
        for (let i = 14; i <= 16; i++) {
            let radios = document.querySelectorAll(`input[name="q${i}"]`);
            radios.forEach(r => {
                let label = r.closest('.mcq-option');
                if (label) {
                    label.classList.remove('correct', 'incorrect');
                }
            });
            let selected = document.querySelector(`input[name="q${i}"]:checked`);
            let correct = answerKey[`q${i}`];
            if (selected) {
                let parentLabel = selected.closest('.mcq-option');
                if (parentLabel) {
                    if (selected.value === correct) parentLabel.classList.add('correct');
                    else parentLabel.classList.add('incorrect');
                }
            }
        }
        
        // Mark Yes/No/NG 17-21
        for (let i = 17; i <= 21; i++) {
            let radios = document.querySelectorAll(`input[name="q${i}"]`);
            radios.forEach(r => {
                let label = r.closest('.tf-option');
                if (label) {
                    label.classList.remove('correct', 'incorrect');
                }
            });
            let selected = document.querySelector(`input[name="q${i}"]:checked`);
            let correct = answerKey[`q${i}`];
            if (selected) {
                let parentLabel = selected.closest('.tf-option');
                if (parentLabel) {
                    if (selected.value === correct) parentLabel.classList.add('correct');
                    else parentLabel.classList.add('incorrect');
                }
            }
        }
        
        // Mark inputs 22-26
        for (let i = 22; i <= 26; i++) {
            let input = document.getElementById(`q${i}`);
            if (input) {
                let userAnswer = input.value.trim().toUpperCase();
                let correct = answerKey[`q${i}`];
                input.classList.remove('correct', 'incorrect-marked');
                if (userAnswer) {
                    if (userAnswer === correct) {
                        input.classList.add('correct');
                    } else {
                        input.classList.add('incorrect-marked');
                    }
                } else {
                    input.classList.add('incorrect-marked');
                }
            }
        }
    }

    // ==================== CALCULATE RESULTS ====================
    function calculateResults() {
        let correct = 0;
        let total = 13;
        
        for (let i = 14; i <= 26; i++) {
            let u = getUserAnswer(i);
            if (u && u.toString().toUpperCase() === answerKey[`q${i}`].toString().toUpperCase()) correct++;
        }
        
        const percentage = Math.round(correct / total * 100);
        const timeTaken = Math.floor((Date.now() - startTime) / 1000);
        const minutes = Math.floor(timeTaken / 60);
        const seconds = timeTaken % 60;
        
        return {
            correct,
            total,
            percentage,
            timeString: `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`
        };
    }

    // ==================== SETUP EYE ICONS ====================
    function setupEyeIcons() {
        document.querySelectorAll('.eye-icon').forEach(icon => {
            icon.addEventListener('click', function(e) {
                e.stopPropagation();
                const questionNum = this.getAttribute('data-question');
                
                if (this.classList.contains('active')) {
                    clearAllHighlights();
                    document.getElementById('explanationPanel').classList.remove('show');
                } else {
                    showExplanation(questionNum);
                }
            });
        });
    }

    document.getElementById('closeExplanation').addEventListener('click', () => {
        document.getElementById('explanationPanel').classList.remove('show');
        clearAllHighlights();
    });

    // ==================== SUBMIT ====================
    document.getElementById('submitBtn').addEventListener('click', () => {
        if (examSubmitted) return;
        
        let unanswered = [];
        for (let i = 14; i <= 26; i++) {
            if (!getUserAnswer(i)) unanswered.push(i);
        }
        
        if (unanswered.length > 0) {
            const confirmSubmit = confirm(`B·∫°n c√≤n ${unanswered.length} c√¢u ch∆∞a l√†m. B·∫°n c√≥ ch·∫Øc mu·ªën n·ªôp b√†i?`);
            if (!confirmSubmit) return;
        }
        
        examSubmitted = true;
        endTime = Date.now();
        
        markAnswers();
        
        const results = calculateResults();
        
        const resultStats = document.getElementById('resultStats');
        resultStats.style.display = 'inline-block';
        resultStats.textContent = `K·∫øt qu·∫£: ${results.correct}/${results.total} (${results.percentage}%) - Th·ªùi gian: ${results.timeString}`;
        
        // M·ªû KH√ìA n√∫t xem gi·∫£i th√≠ch
        document.getElementById('explainBtn').disabled = false;
        
        document.getElementById('submitBtn').disabled = true;
        document.getElementById('submitBtn').textContent = 'ƒê√£ n·ªôp b√†i';
        
        document.getElementById('explanationPanel').classList.add('show');
        document.getElementById('explanationTitle').textContent = 'K·∫æT QU·∫¢ B√ÄI L√ÄM';
        document.getElementById('explanationText').innerHTML = `
            <h4>K·∫øt qu·∫£ b√†i l√†m:</h4>
            <p><strong>S·ªë c√¢u ƒë√∫ng:</strong> ${results.correct}/${results.total}</p>
            <p><strong>T·ª∑ l·ªá ƒë√∫ng:</strong> ${results.percentage}%</p>
            <p><strong>Th·ªùi gian l√†m b√†i:</strong> ${results.timeString}</p>
            <p>Nh·∫•n "Xem gi·∫£i th√≠ch" ƒë·ªÉ xem chi ti·∫øt t·ª´ng c√¢u.</p>
        `;
    });

    // ==================== EXPLAIN ====================
    document.getElementById('explainBtn').addEventListener('click', function() {
        if (!examSubmitted) return;  // Ch·ªâ ho·∫°t ƒë·ªông khi ƒë√£ n·ªôp b√†i
        
        explanationMode = true;
        
        // Hi·ªán eye icons
        document.querySelectorAll('.eye-icon').forEach(icon => {
            icon.style.display = 'inline-block';
        });
        
        // KH√ìA n√∫t xem gi·∫£i th√≠ch l·∫°i (chuy·ªÉn th√†nh ƒêang xem gi·∫£i th√≠ch)
        this.disabled = true;
        this.textContent = 'ƒêang xem gi·∫£i th√≠ch';
        
        document.getElementById('explanationPanel').classList.remove('show');
        clearAllHighlights();
    });

    // ==================== RESET ====================
    document.getElementById('resetBtn').addEventListener('click', () => {
        if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën reset t·∫•t c·∫£? M·ªçi c√¢u tr·∫£ l·ªùi s·∫Ω b·ªã x√≥a.')) {
            examSubmitted = false;
            explanationMode = false;
            startTime = Date.now();
            
            // Reset radios 14-21
            for (let i = 14; i <= 21; i++) {
                let radios = document.querySelectorAll(`input[name="q${i}"]`);
                radios.forEach(radio => radio.checked = false);
            }
            
            // Reset class cho labels
            document.querySelectorAll('.mcq-option, .tf-option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });
            
            // Reset inputs 22-26
            for (let i = 22; i <= 26; i++) {
                let input = document.getElementById(`q${i}`);
                if (input) {
                    input.value = '';
                    input.classList.remove('correct', 'incorrect-marked');
                }
            }
            
            // Hide eye icons
            document.querySelectorAll('.eye-icon').forEach(icon => {
                icon.style.display = 'none';
            });
            
            // Reset buttons
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('submitBtn').textContent = 'N·ªôp b√†i';
            
            // Reset n√∫t xem gi·∫£i th√≠ch v·ªÅ tr·∫°ng th√°i kh√≥a
            document.getElementById('explainBtn').disabled = true;
            document.getElementById('explainBtn').textContent = 'Xem gi·∫£i th√≠ch';
            
            document.getElementById('resultStats').style.display = 'none';
            document.getElementById('explanationPanel').classList.remove('show');
            
            // Clear highlights
            document.querySelectorAll('.answer-highlight, .question-highlight, .highlight-yellow, .highlight-green, .highlight-pink').forEach(el => {
                const parent = el.parentNode;
                if (parent) {
                    while (el.firstChild) {
                        parent.insertBefore(el.firstChild, el);
                    }
                    parent.removeChild(el);
                }
            });
            
            clearAllHighlights();
            updateAnswerCount();
        }
    });

    // ==================== RIGHT-CLICK HIGHLIGHT ====================
    const contextMenu = document.getElementById('contextMenu');
    
    document.getElementById('readingContent').addEventListener('contextmenu', (e) => {
        e.preventDefault();
        const selection = window.getSelection();
        if (selection.toString().trim() === '') return;
        selectedRange = selection.getRangeAt(0);
        contextMenu.style.display = 'block';
        contextMenu.style.left = e.pageX + 'px';
        contextMenu.style.top = e.pageY + 'px';
    });

    document.getElementById('questionsContent').addEventListener('contextmenu', (e) => {
        e.preventDefault();
        const selection = window.getSelection();
        if (selection.toString().trim() === '') return;
        selectedRange = selection.getRangeAt(0);
        contextMenu.style.display = 'block';
        contextMenu.style.left = e.pageX + 'px';
        contextMenu.style.top = e.pageY + 'px';
    });

    document.addEventListener('click', () => {
        contextMenu.style.display = 'none';
    });

    window.applyHighlight = (color) => {
        if (!selectedRange) return;
        try {
            const span = document.createElement('span');
            span.className = `highlight-${color}`;
            const range = selectedRange.cloneRange();
            const contents = range.extractContents();
            span.appendChild(contents);
            range.insertNode(span);
        } catch (e) {
            alert('Kh√¥ng th·ªÉ highlight ƒëo·∫°n n√†y');
        }
        contextMenu.style.display = 'none';
        selectedRange = null;
    };

    window.removeHighlight = () => {
        if (!selectedRange) return;
        const range = selectedRange.cloneRange();
        document.querySelectorAll('.highlight-yellow, .highlight-green, .highlight-pink').forEach(h => {
            if (range.intersectsNode(h)) {
                const parent = h.parentNode;
                while (h.firstChild) {
                    parent.insertBefore(h.firstChild, h);
                }
                parent.removeChild(h);
            }
        });
        window.getSelection().removeAllRanges();
        contextMenu.style.display = 'none';
        selectedRange = null;
    };

    // ==================== INIT ====================
    createNavButtons();
    updateAnswerCount();
    setupEyeIcons();
    
    // Auto update on input change
    document.querySelectorAll('input[type="radio"], .letter-input').forEach(el => {
        el.addEventListener('change', updateAnswerCount);
        if (el.classList.contains('letter-input')) {
            el.addEventListener('input', function() {
                this.value = this.value.toUpperCase();
                updateAnswerCount();
            });
        }
    });
</script>
</body>
</html>
